<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bedroom 1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    </head>

    <style>
        .shake {
            animation: shake 0.4s ease;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            20% { transform: translateX(-6px); }
            40% { transform: translateX(6px); }
            60% { transform: translateX(-6px); }
            80% { transform: translateX(6px); }
            100% { transform: translateX(0); }
        }
        input[type="color"] {
            padding: 0 !important;
        }
        input[type="color"]::-webkit-color-swatch-wrapper {
            padding: 0 !important;
        }
        input[type="color"]::-webkit-color-swatch {
            border: none !important;
            border-radius: 0.75rem;
        }
    </style>

    <body class="min-h-screen bg-gradient-to-br from-blue-200 to-blue-50 p-8">
        <!-- Back Button -->
        <a href="../rooms.html" class="inline-block mb-6 px-4 py-2 rounded-xl bg-blue-600 text-white font-semibold hover:bg-blue-700">
        ‚Üê Back
        </a>

        <p class="mt-2 mb-5 py-2 text-3xl text-black font-bold">Parent's Bedroom Settings</p>

        <div class="p-6 bg-white shadow-xl rounded-3xl space-y-8">

        <!-- Lamp Card -->
        <div class="p-6 rounded-3xl shadow-inner bg-gradient-to-b from-gray-900 to-gray-700">

            <h2 class="text-xl font-bold text-blue-200 mb-4">üí° Main Lamp</h2>

            <!-- Dark background + spotlight -->
            <div class="relative flex justify-center items-center">

            <!-- Dark room background -->
            <div class="absolute w-48 h-48 bg-black rounded-full blur-3xl opacity-70"></div>

            <!-- Lamp glow -->
            <div id="lampGlow"
                class="relative w-32 h-32 rounded-full transition-all duration-500 shadow-xl"
                style="background: #111;">
            </div>

            </div>

            <div class="flex items-center justify-between mt-5">
            <span class="font-medium text-gray-200">Lamp Status:</span>
            <button 
                id="lampToggle"
                class="px-4 py-2 rounded-xl font-semibold 
                    bg-gray-300 text-gray-900 hover:bg-gray-400 transition">
                OFF
            </button>
            </div>

            <!-- Brightness Slider -->
            <div class="mt-4">
                <label class="font-medium text-gray-300">
                    Brightness: <span id="brightnessValue" class="text-white font-semibold ml-1">50%</span>
                </label>

                <input id="brightnessSlider" 
                    type="range" 
                    min="1" 
                    max="100" 
                    value="50"
                    class="w-full accent-blue-500 mt-2">
            </div>

            <!-- Color Picker -->
            <div class="mt-0">
                <label class="font-medium text-gray-300">Light Color</label>
                <input id="colorPicker" type="color" value="#ffffff"
                    class="block w-full h-12 rounded-xl mt-2 cursor-pointer border border-gray-300">
            </div>
        </div>

        <!-- Door Lock -->
            <div class="p-6 bg-white rounded-3xl shadow-xl border border-gray-100 flex flex-col items-center text-center">

                <h2 class="text-xl font-bold text-gray-700 mb-2">üö™ Front Door Lock</h2>

                <div id="lockIconWrapper" class="p-6 rounded-full bg-red-100 mb-4 transition-colors duration-500">
                    <span id="lockIcon" class="text-5xl">üîí</span>
                </div>

                <div class="mb-6">
                    <p class="text-gray-500 text-sm font-medium">CURRENT STATUS</p>
                    <p id="lockStatusText" class="text-2xl font-bold text-red-600 transition-colors">LOCKED</p>
                </div>

                <button id="masterLockBtn"
                        class="w-full py-3 px-6 rounded-xl font-bold text-white bg-blue-600 hover:bg-blue-700 active:scale-95 transition-all shadow-lg flex items-center justify-center gap-2">
                    <span>üîì Remote Unlock</span>
                </button>

                <p class="mt-4 text-xs text-gray-400">
                    Admin Override ‚Ä¢ No PIN Required
                </p>
            </div>
        </div>

    </body>
</html>

<script src="../../iot-api.js"></script>
<script>
    // -------------------------------------------------------
    // KONFIGURASI KHUSUS PARENT ROOM
    // Di sini kita "mengikat" UI Parent Room ke Device ID tertentu
    // -------------------------------------------------------

    document.addEventListener("DOMContentLoaded", () => {

        // 1. Inisialisasi Lampu Parent
        const parentLamp = initSmartLamp({
            deviceId: "parent-lamp-01", // <--- INI KUNCI UTAMANYA (Harus unik per kamar)
            toggleBtn: document.getElementById("lampToggle"),
            glowEl: document.getElementById("lampGlow"),
            sliderEl: document.getElementById("brightnessSlider"),
            valueEl: document.getElementById("brightnessValue"),
            colorEl: document.getElementById("colorPicker")
        });

        // Daftarkan ke sistem polling agar otomatis update
        registerDevice(parentLamp);


        // 2. Setup Door Lock
        const parentLock = initSmartLock({
            deviceId: "parent-lock-01",

            // Masukkan ID elemen dari Card Admin Dashboard
            iconWrapperEl: document.getElementById("lockIconWrapper"),
            iconEl: document.getElementById("lockIcon"),
            statusTextEl: document.getElementById("lockStatusText"),
            toggleBtnEl: document.getElementById("masterLockBtn")
        });
        registerDevice(parentLock);
    });

</script>

<!--<script>-->
<!--let pin = "";-->
<!--const correctPin = "1234";-->

<!--function pressKey(num) {-->
<!--    if (pin.length >= 4) return;-->
<!--    pin += num;-->
<!--    updateDots();-->

<!--    if (pin.length === 4) {-->
<!--        validatePin();-->
<!--    }-->
<!--}-->

<!--function updateDots() {-->
<!--    const dots = document.querySelectorAll("#pinDots div");-->
<!--    dots.forEach((d, i) => {-->
<!--        d.style.background = i < pin.length ? "#dc2626" : "rgba(255,255,255,0.6)";-->
<!--    });-->
<!--}-->

<!--function validatePin() {-->
<!--    if (pin === correctPin) {-->
<!--        unlockDoor();-->
<!--    } else {-->
<!--        wrongPin();-->
<!--    }-->
<!--}-->

<!--function unlockDoor() {-->
<!--    document.getElementById("lockIcon").textContent = "üîì";-->
<!--    // document.getElementById("lockIcon").classList.add("scale-125");-->
<!--    -->
<!--    const status = document.getElementById("lockStatus");-->
<!--    status.textContent = "Unlocked";-->
<!--    status.classList.remove("text-red-700");-->
<!--    status.classList.add("text-green-700");-->

<!--    // Change background to green-->
<!--    const wrapper = document.getElementById("doorWrapper");-->
<!--    wrapper.classList.remove("from-red-100", "to-red-200");-->
<!--    wrapper.classList.add("from-green-100", "to-green-200", "border-green-300/40");-->

<!--    // Hide keypad, show lock again button-->
<!--    document.getElementById("keypad").classList.add("hidden");-->
<!--    document.getElementById("lockAgainBtn").classList.remove("hidden");-->

<!--    clearPin();-->
<!--}-->

<!--function wrongPin() {-->
<!--    const dots = document.getElementById("pinDots");-->
<!--    dots.classList.add("shake");-->

<!--    setTimeout(() => dots.classList.remove("shake"), 400);-->
<!--    clearPin();-->
<!--}-->

<!--function clearPin() {-->
<!--    pin = "";-->
<!--    updateDots();-->
<!--}-->

<!--function lockDoor() {-->
<!--    const status = document.getElementById("lockStatus");-->
<!--    status.textContent = "Locked";-->
<!--    status.classList.remove("text-green-700");-->
<!--    status.classList.add("text-red-700");-->

<!--    const wrapper = document.getElementById("doorWrapper");-->

<!--    // return background to red-->
<!--    wrapper.classList.add("from-red-100", "to-red-200", "border-red-300/40");-->
<!--    wrapper.classList.remove("from-green-100", "to-green-200", "border-green-300/40");-->

<!--    document.getElementById("lockIcon").textContent = "üîí";-->
<!--    document.getElementById("lockIcon").classList.remove("scale-125");-->

<!--    // Show keypad again-->
<!--    document.getElementById("keypad").classList.remove("hidden");-->
<!--    document.getElementById("lockAgainBtn").classList.add("hidden");-->
<!--}-->
<!--</script>-->
